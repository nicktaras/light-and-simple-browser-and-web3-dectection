<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Device Detection App</title>
</head>
<body>

  <div id="app"></div>

  <script>

    const inBrowser = typeof window !== 'undefined';

    // get user agent
    const UA = inBrowser && window.navigator.userAgent.toLowerCase()

    // detect browser
    const isIE = UA && /msie|trident/.test(UA)
    const isIE9 = UA && UA.indexOf('msie 9.0') > 0
    const isEdge = UA && UA.indexOf('edge/') > 0
    const isChrome = UA && /chrome\/\d+/.test(UA) && !isEdge
    const isPhantomJS = UA && /phantomjs/.test(UA)
    const isFF = UA && UA.match(/firefox\/(\d+)/)

    // detect OS
    const isAndroid = UA && UA.indexOf('android') > 0
    const isIOS = UA && /iphone|ipad|ipod|ios/.test(UA)
    const isSafari = (window.safari) ? true : false;
    const isMobileSafari = !!navigator.userAgent.match(/Version\/[\d\.]+.*Safari/);

    // detect device
    const isMac = window.navigator.platform.toLowerCase().includes("mac");
    const isWindows = window.navigator.platform.toLowerCase().includes("win");
    
    let isWebView = /(Version\/\d+.*\/\d+.0.0.0 Mobile|; ?wv|(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari))/i.test(navigator.userAgent);
    
    const isMetaMask = (ethereum.isMetaMask === true);
    
    let isTouchDevice = null;
    let isMobile = window.matchMedia;
    if (isMobile) {
      let match_mobile = isMobile("(pointer:coarse)");
      isTouchDevice = match_mobile.matches;
    }
    
    safari = /safari/.test( UA ),
    ios = /iphone|ipod|ipad/.test( UA );

    if( ios ) {
        if ( !safari ) {
           isIOSWebView = true;
        };
    }

    document.getElementById("app").innerHTML = `
      <h1>Browser checking</h1>
      <div><br />
      isChrome - ${isChrome}<br /><hr>
      isIE - ${isIE}<br /><hr>
      isEdge - ${isEdge}<br /><hr>
      isIE9 - ${isIE9}<br /><hr>
      isPhantomJS - ${isPhantomJS}<br /><hr>
      isFF - ${isFF}<br /><hr>
      isAndroid - ${isAndroid}<br /><hr>
      isIOS - ${isIOS}<br /><hr>
      isSafari - ${isSafari}<br /><hr>
      isMac - ${isMac}<br /><hr>
      isWindows - ${isWindows}<br /><hr>
      isMobileSafari - ${isMobileSafari}<br /><hr>
      isTouchDevice - ${isTouchDevice ? isTouchDevice : null}<br /><hr>
      isWebView - ${isWebView}<br /><hr>
      isAndroidMetaMask: ${isTouchDevice && isMetaMask && isChrome && isAndroid}<br /><hr>
      isAndroidAlphaWallet: ${isChrome && isAndroid && isMobileSafari && isTouchDevice && isWebView}<br /><hr>
      isAndroidMyEthereumWallet: ${isChrome && isAndroid && isMobileSafari && isTouchDevice && isWebView}<br /><hr>
      isAndroidImToken: ${isChrome && isAndroid && isMobileSafari && isTouchDevice}<br /><hr>
      isIosMetaMask: ${isMetaMask && isWebView}<br /><hr>
      isIosAlphaWallet: ${isIOS && isTouchDevice && isWebView}<br /><hr>
      isIosMyEthereumWallet: ${isMobileSafari && isTouchDevice && isWebView}<br /><hr>
      isIosImToken: ${isMobileSafari && isTouchDevice && isWebView}<br /><hr>
      User Agent to debug: ${window.navigator.userAgent}
      </div>
    `;
    
  </script>
  
</body>
</html>
